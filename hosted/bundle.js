/*
 * ATTENTION: The "eval" devtool has been used (maybe by default in mode: "development").
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
/******/ (() => { // webpackBootstrap
/******/ 	var __webpack_modules__ = ({

/***/ "./client/client.js"
/*!**************************!*\
  !*** ./client/client.js ***!
  \**************************/
() {

eval("{// adds info to index page (after a request has been made) based on the response it recieves\r\nconst handleResponse = async (response, method, url) => {\r\n    // removes query parameters from the url, if they exist\r\n    url = url.split('?')[0];\r\n\r\n    let content;\r\n    switch (url) {\r\n        case \"/getBooks\":\r\n            content = document.querySelector(\"#allContent\");\r\n            break;\r\n        case \"/getTitle\":\r\n            content = document.querySelector(\"#titleContent\");\r\n            break;\r\n        case \"/getAuthor\":\r\n            content = document.querySelector(\"#authorContent\");\r\n            break;\r\n        case \"/getLanguage\":\r\n            content = document.querySelector(\"#langContent\");\r\n            break;\r\n        case \"/getYear\":\r\n            content = document.querySelector(\"#yearContent\");\r\n            break;\r\n        case \"/getGenre\":\r\n            content = document.querySelector(\"#genreContent\");\r\n            break;\r\n        case \"/addBook\":\r\n            content = document.querySelector(\"#addBookContent\");\r\n            break;\r\n        case \"/addReview\":\r\n            content = document.querySelector(\"#reviewBookContent\");\r\n            break;\r\n        default:\r\n            content = document.querySelector(\"#allContent\");\r\n            console.log(\"Unhandled url\")\r\n            break;\r\n    }\r\n\r\n    let contentString = `<section class=\"printed-content\"><p><span>Status Code:</span> ${response.status}</p>`;\r\n    contentString += `<p><span>Content Length:</span> ${response.headers.get(\"Content-Length\")}</p>`;\r\n\r\n    // only gets the response body (and displays something from it) if the response has a body\r\n    if (method === \"get\" || (method === \"post\" && response.status !== 204)) {\r\n        const responseText = await response.json();\r\n        contentString += `<p><span>Response Contents:</span> ${JSON.stringify(responseText)}</p>`;\r\n    }\r\n    contentString += `</section>`;\r\n\r\n    content.innerHTML = contentString;\r\n}\r\n\r\nconst sendGetOrHead = async (url, method) => {\r\n    const response = await fetch(url, {\r\n        method: method,\r\n    });\r\n\r\n    handleResponse(response, method, url);\r\n}\r\n\r\n// sends a post request to /addUser based on form data\r\nconst sendPost = async (formName) => {\r\n    const url = formName.getAttribute('action');\r\n    const method = formName.getAttribute('method');\r\n    let formData;\r\n\r\n    if (url === '/addReview') {\r\n        const title = document.querySelector(\"#reviewTitleField\").value;\r\n        const review = document.querySelector(\"#ratingField\").value;\r\n        formData = JSON.stringify({ title, review });\r\n    }\r\n\r\n    else {\r\n        const title = document.querySelector(\"#addTitleField\").value;\r\n        const author = document.querySelector(\"#addAuthorField\").value;\r\n        const language = document.querySelector(\"#addLanguageField\").value;\r\n        const year = document.querySelector(\"#addDateField\").value;\r\n        const genres = document.querySelector(\"#addGenreField\").value.split(',');\r\n        formData = JSON.stringify({ title, author, language, year, genres });\r\n    }\r\n\r\n    // send fetch request w/ data retrieved\r\n    const response = await fetch(url, {\r\n        method: method,\r\n        headers: {\r\n            'Content-Type': 'application/json',\r\n            'Content-Length': formData.length,\r\n        },\r\n        body: formData,\r\n    });\r\n\r\n    handleResponse(response, method, url);\r\n}\r\n\r\nconst constructRequestInfo = async (paramName1 = \"all\", paramName2 = \"\") => {\r\n    const method = document.querySelector(`#${paramName1}MethodSelect`).value;\r\n    let url = '/getBooks';\r\n\r\n    // if query parameters are given, add them to the request url\r\n    if (paramName1 !== \"all\") {\r\n        const paramValue1 = document.querySelector(`#${paramName1}Field`).value;\r\n        // url = /getParam?param=paramValue\r\n        url = `/get${paramName1.charAt(0).toUpperCase() + paramName1.slice(1)}`;\r\n        if (paramValue1) {\r\n            url += `?${paramName1}=${paramValue1}`;\r\n        }\r\n    }\r\n\r\n    if (paramName2) {\r\n        const paramValue2 = document.querySelector(`#${paramName2}Field`).value;\r\n        if (paramValue2) {\r\n            url += `&${paramName2}=${paramValue2}`;\r\n        }\r\n    }\r\n\r\n    // send fetch request w/ retrieved form data\r\n    sendGetOrHead(url, method);\r\n}\r\n\r\n// sends a get or head request to a given page based on form data\r\nconst requestAllBooksData = async () => {\r\n    constructRequestInfo();\r\n}\r\n\r\nconst requestTitleData = async () => {\r\n    constructRequestInfo('title');\r\n}\r\n\r\nconst requestAuthorData = async () => {\r\n    constructRequestInfo('author');\r\n}\r\n\r\nconst requestLanguageData = async () => {\r\n    constructRequestInfo('language');\r\n}\r\n\r\nconst requestGenreData = async () => {\r\n    constructRequestInfo('genre');\r\n}\r\n\r\nconst requestYearData = async () => {\r\n    constructRequestInfo('year', 'end');\r\n}\r\n\r\nconst cancelFormAction = (e, func) => {\r\n    e.preventDefault();\r\n    func();\r\n    return false;\r\n}\r\n\r\n// adds submit event listeners to both forms\r\nconst init = () => {\r\n    const getBooksForm = document.querySelector(\"#allBooksForm\");\r\n    const getTitleForm = document.querySelector(\"#titleForm\");\r\n    const getAuthorForm = document.querySelector(\"#authorForm\");\r\n    const getLanguageForm = document.querySelector(\"#languageForm\");\r\n    const getYearForm = document.querySelector(\"#yearForm\");\r\n    const getGenreForm = document.querySelector(\"#genreForm\");\r\n\r\n    const addBookForm = document.querySelector(\"#addBookForm\");\r\n    const addReviewForm = document.querySelector(\"#reviewBookForm\");\r\n\r\n    const clearButton = document.querySelector('#clearAllContent')\r\n\r\n    const addBook = (e) => {\r\n        e.preventDefault();\r\n        sendPost(addBookForm);\r\n        return false;\r\n    }\r\n\r\n    const reviewBook = (e) => {\r\n        e.preventDefault();\r\n        sendPost(addReviewForm);\r\n        return false;\r\n    }\r\n\r\n    const clearPage = () => {\r\n        const contentSections = document.querySelectorAll(\".content\");\r\n        contentSections.forEach(section => {\r\n            section.innerHTML = '';\r\n        });\r\n    }\r\n\r\n    getBooksForm.addEventListener('submit', (e) => { cancelFormAction(e, requestAllBooksData) });\r\n    getTitleForm.addEventListener('submit', (e) => { cancelFormAction(e, requestTitleData) });\r\n    getAuthorForm.addEventListener('submit', (e) => { cancelFormAction(e, requestAuthorData) });\r\n    getLanguageForm.addEventListener('submit', (e) => { cancelFormAction(e, requestLanguageData) });\r\n    getYearForm.addEventListener('submit', (e) => { cancelFormAction(e, requestYearData) });\r\n    getGenreForm.addEventListener('submit', (e) => { cancelFormAction(e, requestGenreData) });\r\n\r\n    addBookForm.addEventListener('submit', addBook);\r\n    addReviewForm.addEventListener('submit', reviewBook);\r\n\r\n    clearButton.addEventListener('click', clearPage);\r\n}\r\n\r\nwindow.onload = init;\r\n\n\n//# sourceURL=webpack://430-web-api/./client/client.js?\n}");

/***/ }

/******/ 	});
/************************************************************************/
/******/ 	
/******/ 	// startup
/******/ 	// Load entry module and return exports
/******/ 	// This entry module can't be inlined because the eval devtool is used.
/******/ 	var __webpack_exports__ = {};
/******/ 	__webpack_modules__["./client/client.js"]();
/******/ 	
/******/ })()
;